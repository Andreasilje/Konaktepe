---
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
  const endpoint = "https://yvsqeurljhxwfykzgfyb.supabase.co/rest/v1/Konaktepe_nails?select=*";
  const key = `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl2c3FldXJsamh4d2Z5a3pnZnliIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI5Nzc0ODMsImV4cCI6MjA3ODU1MzQ4M30.tQHxzSel-Iqvcvuh9XBVKsvHr-oNSd8XLUyhsGABUGo`;

  const options = {
    method: "GET",
    headers: {
      apikey: key,
    },
  };
  const response = await fetch(endpoint, options);
  const data = await response.json();

  return data.map((post) => {
    return {
      params: { id: post.id },
      props: { post },
    };
  });
}

const { id } = Astro.params;
const { post } = Astro.props;
---

<Layout>
  <section class="product-detail">
    <div class="product-grid">
      <div class="product-img">
        <img src=`https://yvsqeurljhxwfykzgfyb.supabase.co/storage/v1/object/public/konaktepe_images/${post.image}` alt="product image" />
      </div>
      <div class="product-content">
        <h1>{id}: {post.productname}</h1>
        <p>{post.price}</p>
        <div class="product-info">
          <h2>Beskrivelse</h2>
          <p>{post.description}</p>
        </div>
        <div class="product-info">
          <h2>Camillas anbefaling</h2>
          <p>{post.recommendation}</p>
        </div>
        <div class="product-info">
          <h2>SÃ¥dan bruger du produktet</h2>
          <p>{post.howtouse}</p>
        </div>
      </div>
    </div>
  </section>
</Layout>

<style>
  /* grid*/
  .product-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 3rem;
    align-items: start;
  }

  .product-img img {
    width: 100%;
    display: block;
    border-radius: 6px;
  }

  .product-content {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }
  .product-info p {
    line-height: 1.6;
  }
</style>
